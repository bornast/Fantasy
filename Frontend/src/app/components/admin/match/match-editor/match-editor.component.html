<app-dashboard-sidemenu></app-dashboard-sidemenu>
<div class="main-content d-flex flex-column">
    <app-dashboard-navbar></app-dashboard-navbar>
    <!-- Start -->
    <div class="entity-list-div">
        <div class="container">
            <div class="pricing-tabs">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Home Team</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#away" type="button" role="tab" aria-controls="away" aria-selected="false">Away team</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#detail" type="button" role="tab" aria-controls="detail" aria-selected="false">Details</button>
                    </li>
                </ul>
                <div class="tab-content" id="myTabContent">
                    
                    <!-- HOME TEAM -->
                    <div class="tab-pane fade show active" id="home" role="tabpanel">
                        <div class="row">

                            <div class="col-lg-12 col-md-12" *ngIf="teams">
                                <div class="form-group">
                                    <label>Home Team</label>
                                    <select name="team" [(ngModel)]="matchToSave.homeTeam.teamId" (ngModelChange)="onHomeTeamChange($event)">
                                        <option *ngFor="let team of teams" [ngValue]="team.id">{{team.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-lg-12 col-md-12" *ngIf="formations">
                                <div class="form-group">
                                    <label>Formation</label>
                                    <select name="formation" [(ngModel)]="matchToSave.homeTeam.formationId">
                                        <option *ngFor="let formation of formations" [ngValue]="formation.id">{{formation.name}}</option>
                                    </select>
                                </div>
                            </div>


                            
                            <ng-container *ngIf="matchToSave.homeTeam && homeTeamPlayers">
                                <div class="row with-forms" *ngFor="let lineupPlayerId of matchToSave.homeTeam.lineupPlayerIds; let i = index">
                                    <div class="col-lg-8 col-md-8">
                                        <div class="form-group">
                                            <label>Lineup Player</label>
                                            <select name="homeTeamPlayer" [(ngModel)]="matchToSave.homeTeam.lineupPlayerIds[i]">
                                                <option *ngFor="let homeTeamPlayer of homeTeamPlayers" [ngValue]="homeTeamPlayer.id">{{homeTeamPlayer.name}}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- <div class="col-md-8">
                                        <label *ngIf="i == 0" class="ml-1">Film</label>
                                        <ng-select 
                                            [items]="films"
                                            class="custom-select form-control-alternative mt-3"
                                            bindLabel="name"
                                            bindValue="id"
                                            [(ngModel)]="this.watchlistToSave.films[i].filmId">
                                        </ng-select>
                                    </div> -->
                                    <div style="padding-top: 50px;" class="col-md-1" *ngIf="i == 0">
                                        <button class="btn btn-primary" (click)="addEmptyHomeLineupPlayer()">Add</button>
                                    </div>
                                    <div style="padding-top: 15px;" class="col-md-1" *ngIf="i > 0">
                                        <button class="btn btn-primary" (click)="addEmptyHomeLineupPlayer()">Add</button>
                                    </div>
                                    <div style="padding-top: 50px;" class="col-md-2" *ngIf="i == 0">
                                        <button class="btn btn-danger" (click)="removeHomeLineupPlayer(i)"
                                            [disabled]="matchToSave.homeTeam.lineupPlayerIds.length == 1">Remove
                                        </button>
                                    </div>
                                    <div style="padding-top: 15px;" class="col-md-2" *ngIf="i > 0">
                                        <button class="btn btn-danger" (click)="removeHomeLineupPlayer(i)"
                                            [disabled]="matchToSave.homeTeam.lineupPlayerIds.length == 1">Remove
                                        </button>
                                    </div>
                                </div>
                            </ng-container>



                        </div>                
                    </div>


                    <!-- AWAY TEAM -->
                    <div class="tab-pane fade" id="away" role="tabpanel">
                        




                    </div>


                    <!-- DETAILS -->
                    <div class="tab-pane fade" id="detail" role="tabpanel">
                        
                        <div class="row">
                            <div class="col-lg-12 col-md-12">
                                <div class="form-group">
                                    <label>Date of Establishment</label>
                                    <input type="datetime-local" [(ngModel)]="matchToSave.matchDate" min="1900-01-01" max="2023-12-31" class="form-control form-control-alternative">
                                </div>
                            </div>
                
                            <div class="col-lg-12 col-md-12" *ngIf="leagues">
                                <div class="form-group">
                                    <label>League</label>
                                    <select name="league" [(ngModel)]="matchToSave.leagueId">
                                        <option *ngFor="let league of leagues" [ngValue]="league.id">{{league.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-lg-12 col-md-12" *ngIf="referees">
                                <div class="form-group">
                                    <label>Referee</label>
                                    <select name="referee" [(ngModel)]="matchToSave.refereeId">
                                        <option *ngFor="let referee of referees" [ngValue]="referee.id">{{referee.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-lg-12 col-md-12" *ngIf="stadiums">
                                <div class="form-group">
                                    <label>Stadium</label>
                                    <select name="stadium" [(ngModel)]="matchToSave.stadiumId">
                                        <option *ngFor="let stadium of stadiums" [ngValue]="stadium.id">{{stadium.name}}</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-lg-12 col-md-12">
                                <div class="form-group">
                                    <label>Spectators</label>
                                    <input type="text" class="form-control" [(ngModel)]="matchToSave.spectatorCount">
                                </div>
                            </div>

                        </div>

                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12 col-sm-12">
                    <button 
                        class="btn btn-primary" 
                        type="button" 
                        [disabled]="!matchToSave.matchDate||!matchToSave.stadiumId"
                        (click)="save()"
                    >Save
                    </button>
                    <button 
                        class="btn btn-secondary"
                        type="button"
                        style="margin-left: 5px;"
                        [routerLink]="['/admin/match-list']"
                    >Cancel
                    </button>
                </div>
            </div>  

        </div>

    </div>

</div>
